"use strict";(self.webpackChunkmhira_docs=self.webpackChunkmhira_docs||[]).push([[6679],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return l}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),h=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=h(e.components);return r.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=h(n),l=i,m=u["".concat(p,".").concat(l)]||u[l]||d[l]||o;return n?r.createElement(m,a(a({ref:t},c),{},{components:n})):r.createElement(m,a({ref:t},c))}));function l(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var h=2;h<o;h++)a[h]=n[h];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2133:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return l},frontMatter:function(){return s},metadata:function(){return h},toc:function(){return d}});var r=n(7462),i=n(3366),o=(n(7294),n(3905)),a=["components"],s={sidebar_position:5},p="Using shiny apps for reporting",h={unversionedId:"mhira-reporting-guide/using-shiny-apps-for-reporting",id:"mhira-reporting-guide/using-shiny-apps-for-reporting",title:"Using shiny apps for reporting",description:"As discussed, MHIRA allows for the connection of external apps for reporting.",source:"@site/docs/5-mhira-reporting-guide/5-using-shiny-apps-for-reporting.md",sourceDirName:"5-mhira-reporting-guide",slug:"/mhira-reporting-guide/using-shiny-apps-for-reporting",permalink:"/documentation/docs/mhira-reporting-guide/using-shiny-apps-for-reporting",draft:!1,editUrl:"https://github.com/mhira-project/documentation/edit/main/docs/5-mhira-reporting-guide/5-using-shiny-apps-for-reporting.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"GraphQL API",permalink:"/documentation/docs/mhira-reporting-guide/graphql_api"},next:{title:"Patient-report shiny app",permalink:"/documentation/docs/mhira-reporting-guide/patient-report-shiny-app"}},c={},d=[{value:"Adding a shiny app to the shiny server in the MHIRA setup.",id:"adding-a-shiny-app-to-the-shiny-server-in-the-mhira-setup",level:2},{value:"Access the shiny app via URL",id:"access-the-shiny-app-via-url",level:2},{value:"Adding a button in MHIRA to connect to your app",id:"adding-a-button-in-mhira-to-connect-to-your-app",level:2},{value:"Access to graphQL API from within shiny server and rstudio server",id:"access-to-graphql-api-from-within-shiny-server-and-rstudio-server",level:2},{value:"Adding R packages to the shiny server",id:"adding-r-packages-to-the-shiny-server",level:2},{value:"Troubleshooting of the shiny app in the shiny container",id:"troubleshooting-of-the-shiny-app-in-the-shiny-container",level:2}],u={toc:d};function l(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"using-shiny-apps-for-reporting"},"Using shiny apps for reporting"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/docs/mhira-reporting-guide/overview"},"As discussed"),", MHIRA allows for the connection of external apps for reporting."),(0,o.kt)("p",null,"By default, MHIRA comes with a ",(0,o.kt)("a",{parentName:"p",href:"https://www.rstudio.com/products/shiny/shiny-server/"},"shiny server")," in form of a ",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/rocker/shiny"},"docker container containing the shiny server"),". The docker setup also comes with an rstudio server to facilitate setting up the shiny apps. The rstudio container is disabled by default and needs to be activated ",(0,o.kt)("a",{parentName:"p",href:"/docs/installation-guide/rstudio"},"as discribed in here"),". To reduce attack surface, it is recommended to disable rstudio during production. "),(0,o.kt)("h2",{id:"adding-a-shiny-app-to-the-shiny-server-in-the-mhira-setup"},"Adding a shiny app to the shiny server in the MHIRA setup."),(0,o.kt)("p",null,"Shiny apps need to be added to the folder '/srv/shiny-server/' inside the shiny docker container (",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/rocker/shiny"},"see rocker/shiny documentation"),").\nIn our MHIRA setup, they need to be added to '/srv/shiny-server/shiny' (this is related to serving the url of the server via the caddy server).\nWe have connected this location to a docker volume called 'shiny_apps' in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mhira-project/mhira-docker/blob/main/docker-compose.yml"},"'mhira-docker.yml'")," file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"volumes:\n  - shiny_apps:/srv/shiny-server/shiny\n")),(0,o.kt)("p",null,"The rstudio container will have access to the same volume. Thus, using the rstudio server, you can add your shiny app to the folder 'shiny_apps' in the home directory of your rstudio user. The app will then be shared with the shiny server via the volume. "),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you do not want to use rstudio to add files, you could for example ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/storage/volumes/"},"change the volume to a mounted location on the host"),". Then, copy your app to the selected location on the host. "))),(0,o.kt)("h2",{id:"access-the-shiny-app-via-url"},"Access the shiny app via URL"),(0,o.kt)("p",null,"The shiny app can now be accessed under this url: "),(0,o.kt)("p",null,"  https://yourMHIRAdomain/shiny/nameOFyourAPP "),(0,o.kt)("h2",{id:"adding-a-button-in-mhira-to-connect-to-your-app"},"Adding a button in MHIRA to connect to your app"),(0,o.kt)("p",null,"Please consult ",(0,o.kt)("a",{parentName:"p",href:"/documentation/docs/guide-for-admins/reports"},"this section"),"."),(0,o.kt)("h2",{id:"access-to-graphql-api-from-within-shiny-server-and-rstudio-server"},"Access to graphQL API from within shiny server and rstudio server"),(0,o.kt)("p",null,"Please refer to the section about the ",(0,o.kt)("a",{parentName:"p",href:"/documentation/docs/mhira-reporting-guide/graphql_api"},"graphql API")),(0,o.kt)("h2",{id:"adding-r-packages-to-the-shiny-server"},"Adding R packages to the shiny server"),(0,o.kt)("p",null,"Packages can be added via the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mhira-project/mhira-docker/blob/main/shiny/Dockerfile"},"shiny server docker file")," with the ",(0,o.kt)("a",{parentName:"p",href:"https://rocker-project.org/use/extending#install2.r"},"install2.R command"),".  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dockerfile"},"RUN install2.r --error \\\n  --deps FALSE \\\n  data.table \\\n  RColorBrewer \\\n  httr \\\n  shinydashboard \\\n  tidyjson \\\n  jsonlite \\\n  htmlwidgets \\\n  DT \\\n  crosstalk\n")),(0,o.kt)("h2",{id:"troubleshooting-of-the-shiny-app-in-the-shiny-container"},"Troubleshooting of the shiny app in the shiny container"),(0,o.kt)("p",null,"If you want to see output from the shiny app you can attach the container to your terminal using the\nintructions found ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/commandline/logs/"},"here"),".\nElse, we recommend to run the app via the rstudio container."))}l.isMDXComponent=!0}}]);