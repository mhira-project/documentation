"use strict";(self.webpackChunkmhira_docs=self.webpackChunkmhira_docs||[]).push([[6679],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return l}});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=n.createContext({}),h=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=h(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=h(r),l=i,y=u["".concat(p,".").concat(l)]||u[l]||d[l]||o;return r?n.createElement(y,a(a({ref:t},c),{},{components:r})):n.createElement(y,a({ref:t},c))}));function l(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var h=2;h<o;h++)a[h]=r[h];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},2133:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return l},frontMatter:function(){return s},metadata:function(){return h},toc:function(){return d}});var n=r(7462),i=r(3366),o=(r(7294),r(3905)),a=["components"],s={sidebar_position:5},p="Using shiny apps for reporting",h={unversionedId:"mhira-reporting-guide/using-shiny-apps-for-reporting",id:"mhira-reporting-guide/using-shiny-apps-for-reporting",title:"Using shiny apps for reporting",description:"As discussed, MHIRA allows for the connection of external apps for reporting.",source:"@site/docs/5-mhira-reporting-guide/5-using-shiny-apps-for-reporting.md",sourceDirName:"5-mhira-reporting-guide",slug:"/mhira-reporting-guide/using-shiny-apps-for-reporting",permalink:"/documentation/docs/mhira-reporting-guide/using-shiny-apps-for-reporting",draft:!1,editUrl:"https://github.com/mhira-project/documentation/edit/main/docs/5-mhira-reporting-guide/5-using-shiny-apps-for-reporting.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"GraphQL API",permalink:"/documentation/docs/mhira-reporting-guide/graphql_api"},next:{title:"Patient-report shiny app",permalink:"/documentation/docs/mhira-reporting-guide/patient-report-shiny-app"}},c={},d=[{value:"Adding a shiny app to the shiny server in the MHIRA setup.",id:"adding-a-shiny-app-to-the-shiny-server-in-the-mhira-setup",level:2},{value:"SHINY",id:"shiny",level:3},{value:"Access the shiny app via URL",id:"access-the-shiny-app-via-url",level:2},{value:"Adding a button in MHIRA to connect to your app",id:"adding-a-button-in-mhira-to-connect-to-your-app",level:2},{value:"Access to graphQL API from within shiny server and rstudio server",id:"access-to-graphql-api-from-within-shiny-server-and-rstudio-server",level:2},{value:"Adding R packages to the shiny server",id:"adding-r-packages-to-the-shiny-server",level:2},{value:"Troubleshooting of the shiny app in the shiny container",id:"troubleshooting-of-the-shiny-app-in-the-shiny-container",level:2}],u={toc:d};function l(e){var t=e.components,r=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"using-shiny-apps-for-reporting"},"Using shiny apps for reporting"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/docs/mhira-reporting-guide/overview"},"As discussed"),", MHIRA allows for the connection of external apps for reporting."),(0,o.kt)("p",null,"By default, MHIRA comes with a ",(0,o.kt)("a",{parentName:"p",href:"https://www.rstudio.com/products/shiny/shiny-server/"},"shiny server")," in form of a ",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/rocker/shiny"},"docker container containing the shiny server"),". The docker setup also comes with an rstudio server to facilitate setting up the shiny apps. The rstudio container is disabled by default and needs to be activated ",(0,o.kt)("a",{parentName:"p",href:"/docs/installation-guide/rstudio"},"as discribed in here"),". To reduce attack surface, it is recommended to disable rstudio during production. "),(0,o.kt)("h2",{id:"adding-a-shiny-app-to-the-shiny-server-in-the-mhira-setup"},"Adding a shiny app to the shiny server in the MHIRA setup."),(0,o.kt)("p",null,"Shiny apps need to be added to the folder '/srv/shiny-server/' inside the shiny docker container (",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/rocker/shiny"},"see rocker/shiny documentation"),").\nIn our MHIRA setup, they need to be added to '/srv/shiny-server/shiny' (this is related to serving the url of the server via the caddy server).\nWe have connected this location to a ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/storage/volumes/"},"mounted docker volume"),", meaning that a folder on the host (server) is synced with this folder. You can change the corresponding variable in the .env file to adjust the path: "),(0,o.kt)("h3",{id:"shiny"},"SHINY"),(0,o.kt)("p",null,"  SHINY_APPS_PATH=~/shiny_apps"),(0,o.kt)("p",null,"Addtionally, the rstudio container will have access to the same volume. Thus, using the rstudio server, you can modify the shiny app directly in this folder. The app will then be shared with the shiny server via the docker volume. "),(0,o.kt)("h2",{id:"access-the-shiny-app-via-url"},"Access the shiny app via URL"),(0,o.kt)("p",null,"The shiny app can now be accessed under this url: "),(0,o.kt)("p",null,"  https://yourMHIRAdomain/shiny/nameOFyourSHINYapp "),(0,o.kt)("h2",{id:"adding-a-button-in-mhira-to-connect-to-your-app"},"Adding a button in MHIRA to connect to your app"),(0,o.kt)("p",null,"Please consult ",(0,o.kt)("a",{parentName:"p",href:"/documentation/docs/guide-for-admins/reports"},"this section"),"."),(0,o.kt)("h2",{id:"access-to-graphql-api-from-within-shiny-server-and-rstudio-server"},"Access to graphQL API from within shiny server and rstudio server"),(0,o.kt)("p",null,"Please refer to the section about the ",(0,o.kt)("a",{parentName:"p",href:"/documentation/docs/mhira-reporting-guide/graphql_api"},"graphql API")),(0,o.kt)("h2",{id:"adding-r-packages-to-the-shiny-server"},"Adding R packages to the shiny server"),(0,o.kt)("p",null,"Packages can be added via the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mhira-project/mhira-docker/blob/main/shiny/Dockerfile"},"shiny server docker file")," with the ",(0,o.kt)("a",{parentName:"p",href:"https://rocker-project.org/use/extending#install2.r"},"install2.R command"),".  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dockerfile"},"RUN install2.r --error \\\n  --deps FALSE \\\n  data.table \\\n  RColorBrewer \\\n  httr \\\n  shinydashboard \\\n  tidyjson \\\n  jsonlite \\\n  htmlwidgets \\\n  DT \\\n  crosstalk\n")),(0,o.kt)("h2",{id:"troubleshooting-of-the-shiny-app-in-the-shiny-container"},"Troubleshooting of the shiny app in the shiny container"),(0,o.kt)("p",null,"If you want to see output from the shiny app you can attach the container to your terminal using the\nintructions found ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/commandline/logs/"},"here"),".\nElse, we recommend to run the app via the rstudio container and use debugging and break points."))}l.isMDXComponent=!0}}]);